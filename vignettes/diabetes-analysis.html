<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael Obuobi, Jinchen Jiang, Far Rahmati" />

<meta name="date" content="2025-12-04" />

<title>Multi-Path AIC Selection: Diabetes Progression Analysis</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Multi-Path AIC Selection: Diabetes
Progression Analysis</h1>
<h4 class="author">Michael Obuobi, Jinchen Jiang, Far Rahmati</h4>
<h4 class="date">2025-12-04</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette demonstrates the multi-path AIC selection procedure on
the diabetes progression dataset from Efron et al. (2004). The dataset
contains 442 patients with 10 baseline predictors measuring various
health indicators, and the goal is to predict a continuous measure of
disease progression one year after baseline.</p>
<p>We extend the predictor set by including second-order interaction and
quadratic terms, resulting in approximately 60 predictors. This creates
a challenging variable selection problem ideal for demonstrating the
multi-path approach.</p>
</div>
<div id="load-the-package-and-data" class="section level1">
<h1>Load the Package and Data</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(multipathaic)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(lars)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Load diabetes data</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(diabetes)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">head</span>(diabetes)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;          x.age        x.sex        x.bmi        x.map         x.tc        x.ldl</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; 1  0.038075906  0.050680119  0.061696207  0.021872355 -0.044223498 -0.034820763</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; 2 -0.001882017 -0.044641637 -0.051474061 -0.026327835 -0.008448724 -0.019163340</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; 3  0.085298906  0.050680119  0.044451213 -0.005670611 -0.045599451 -0.034194466</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; 4 -0.089062939 -0.044641637 -0.011595015 -0.036656447  0.012190569  0.024990593</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; 5  0.005383060 -0.044641637 -0.036384692  0.021872355  0.003934852  0.015596140</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; 6 -0.092695478 -0.044641637 -0.040695940 -0.019442093 -0.068990650 -0.079287844</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;          x.hdl        x.tch        x.ltg        x.glu   y        x2.age</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; 1 -0.043400846 -0.002592262  0.019908421 -0.017646125 151  0.0380759064</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; 2  0.074411564 -0.039493383 -0.068329744 -0.092204050  75 -0.0018820165</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; 3 -0.032355932 -0.002592262  0.002863771 -0.025930339 141  0.0852989063</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; 4 -0.036037570  0.034308859  0.022692023 -0.009361911 206 -0.0890629394</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; 5  0.008142084 -0.002592262 -0.031991445 -0.046640874 135  0.0053830604</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; 6  0.041276824 -0.076394504 -0.041180385 -0.096346157  97 -0.0926954778</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;          x2.sex        x2.bmi        x2.map         x2.tc        x2.ldl</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; 1  0.0506801187  0.0616962065  0.0218723550 -0.0442234984 -0.0348207628</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; 2 -0.0446416365 -0.0514740612 -0.0263278347 -0.0084487241 -0.0191633397</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; 3  0.0506801187  0.0444512133 -0.0056706106 -0.0455994513 -0.0341944659</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; 4 -0.0446416365 -0.0115950145 -0.0366564468  0.0121905688  0.0249905934</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; 5 -0.0446416365 -0.0363846922  0.0218723550  0.0039348516  0.0155961395</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; 6 -0.0446416365 -0.0406959405 -0.0194420933 -0.0689906499 -0.0792878444</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt;          x2.hdl        x2.tch        x2.ltg        x2.glu      x2.age^2</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; 1 -0.0434008457 -0.0025922620  0.0199084209 -0.0176461252 -0.0148551625</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; 2  0.0744115641 -0.0394933829 -0.0683297436 -0.0922040496 -0.0412915429</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt; 3 -0.0323559322 -0.0025922620  0.0028637705 -0.0259303390  0.0916434391</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; 4 -0.0360375700  0.0343088589  0.0226920226 -0.0093619113  0.1036403301</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; 5  0.0081420836 -0.0025922620 -0.0319914449 -0.0466408736 -0.0408265979</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt; 6  0.0412768238 -0.0763945038 -0.0411803852 -0.0963461565  0.1157092549</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt;        x2.bmi^2      x2.map^2       x2.tc^2      x2.ldl^2      x2.hdl^2</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#&gt; 1  0.0225045739 -0.0310446765 -0.0043311197 -0.0137399243 -0.0046314248</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#&gt; 2  0.0056427733 -0.0273076609 -0.0309389016 -0.0248010319  0.0400365241</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#&gt; 3 -0.0041764214 -0.0388099038 -0.0025859366 -0.0143055611 -0.0148614560</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#&gt; 4 -0.0310170859 -0.0159874156 -0.0298483890 -0.0214340114 -0.0117828858</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a><span class="co">#&gt; 5 -0.0136807215 -0.0310446765 -0.0317282077 -0.0264236384 -0.0268506700</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a><span class="co">#&gt; 6 -0.0088370145 -0.0327918526  0.0352626533  0.0526602897 -0.0068304035</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a><span class="co">#&gt;        x2.tch^2      x2.ltg^2      x2.glu^2    x2.age:sex    x2.age:bmi</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="co">#&gt; 1 -0.0304484629 -0.0288162192 -0.0275255618  0.0328649758  0.0405716741</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="co">#&gt; 2 -0.0094854824  0.0371612444  0.0880219609 -0.0066099928 -0.0067648038</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="co">#&gt; 3 -0.0304484629 -0.0348099250 -0.0224326123  0.0840517453  0.0708891293</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a><span class="co">#&gt; 4 -0.0146503349 -0.0269850701 -0.0306820952  0.0766292449  0.0129034054</span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="co">#&gt; 5 -0.0304484629 -0.0191324512 -0.0012284185 -0.0135465959 -0.0129173209</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="co">#&gt; 6  0.0482386067 -0.0087497144  0.0990402558  0.0800975464  0.0704832806</span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="co">#&gt;      x2.age:map     x2.age:tc    x2.age:ldl    x2.age:hdl    x2.age:tch</span></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="co">#&gt; 1  0.0016606410 -0.0465532511 -0.0382447104 -0.0345115069 -0.0121122609</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="co">#&gt; 2 -0.0159342243 -0.0117287997 -0.0096555406  0.0006995477 -0.0083689963</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="co">#&gt; 3 -0.0279128687 -0.0917442739 -0.0716415163 -0.0602920920 -0.0147605279</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a><span class="co">#&gt; 4  0.0562904032 -0.0342989420 -0.0571356258  0.0786805432 -0.0760817036</span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a><span class="co">#&gt; 5 -0.0144024121 -0.0116206046 -0.0086502423  0.0049801694 -0.0102788452</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="co">#&gt; 6  0.0234365273  0.1189685396  0.1438718189 -0.0851146968  0.1432199339</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a><span class="co">#&gt;      x2.age:ltg    x2.age:glu    x2.sex:bmi    x2.sex:map     x2.sex:tc</span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a><span class="co">#&gt; 1  0.0030648916 -0.0302775066  0.0621030123  0.0122820371 -0.0485722318</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a><span class="co">#&gt; 2 -0.0102016795 -0.0113801440  0.0445181909  0.0137392710  0.0062226212</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a><span class="co">#&gt; 3 -0.0077635174 -0.0646990887  0.0435615292 -0.0181579597 -0.0500315236</span></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="co">#&gt; 4 -0.0555091413  0.0033785934  0.0067497817  0.0237941848 -0.0130586592</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a><span class="co">#&gt; 5 -0.0165418441 -0.0208710562  0.0302274415 -0.0331836602 -0.0053461470</span></span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a><span class="co">#&gt; 6  0.0675437504  0.1843686827  0.0343105127  0.0070359951  0.0627810439</span></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a><span class="co">#&gt;      x2.sex:ldl    x2.sex:hdl    x2.sex:tch    x2.sex:ltg    x2.sex:glu</span></span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a><span class="co">#&gt; 1 -0.0441240238 -0.0308042981 -0.0195479919  0.0142268228 -0.0293859648</span></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a><span class="co">#&gt; 2  0.0112617659 -0.0565675488  0.0224021267  0.0575880019  0.0784642525</span></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a><span class="co">#&gt; 3 -0.0434530875 -0.0179545693 -0.0195479919 -0.0041216840 -0.0384231554</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a><span class="co">#&gt; 4 -0.0304033769  0.0566194244 -0.0505546014 -0.0287218500 -0.0011399371</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a><span class="co">#&gt; 5 -0.0215384529  0.0113446351 -0.0140762373  0.0231308241  0.0346819482</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a><span class="co">#&gt; 6  0.0679972794 -0.0226114568  0.0588804908  0.0318440815  0.0824444620</span></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a><span class="co">#&gt;      x2.bmi:map     x2.bmi:tc    x2.bmi:ldl    x2.bmi:hdl    x2.bmi:tch</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a><span class="co">#&gt; 1  0.0090008988 -0.0717180778 -0.0603176794 -0.0413575386 -0.0240342004</span></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a><span class="co">#&gt; 2  0.0091148702 -0.0028355367  0.0087097314 -0.0671553344  0.0240456899</span></span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a><span class="co">#&gt; 3 -0.0226918084 -0.0564432291 -0.0464818380 -0.0136167525 -0.0230540270</span></span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a><span class="co">#&gt; 4 -0.0092925186 -0.0153834201 -0.0193921008  0.0279274131 -0.0292499537</span></span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a><span class="co">#&gt; 5 -0.0334523099 -0.0154230197 -0.0255070025  0.0119441348 -0.0184594644</span></span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a><span class="co">#&gt; 6 -0.0020460266  0.0488321410  0.0580412284 -0.0190229456  0.0476394964</span></span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a><span class="co">#&gt;      x2.bmi:ltg    x2.bmi:glu     x2.map:tc    x2.map:ldl    x2.map:hdl</span></span>
<span id="cb2-76"><a href="#cb2-76" tabindex="-1"></a><span class="co">#&gt; 1  0.0048261936 -0.0410278367 -0.0327209536 -0.0257474212 -0.0112074291</span></span>
<span id="cb2-77"><a href="#cb2-77" tabindex="-1"></a><span class="co">#&gt; 2  0.0552994440  0.0806093115 -0.0070399803  0.0018462404 -0.0319794277</span></span>
<span id="cb2-78"><a href="#cb2-78" tabindex="-1"></a><span class="co">#&gt; 3 -0.0194513972 -0.0423606977 -0.0062598621 -0.0049233843  0.0120934525</span></span>
<span id="cb2-79"><a href="#cb2-79" tabindex="-1"></a><span class="co">#&gt; 4 -0.0280603703 -0.0160690142 -0.0214874364 -0.0291135216  0.0354925517</span></span>
<span id="cb2-80"><a href="#cb2-80" tabindex="-1"></a><span class="co">#&gt; 5  0.0034088636  0.0170453175 -0.0099837004 -0.0017149265  0.0119825521</span></span>
<span id="cb2-81"><a href="#cb2-81" tabindex="-1"></a><span class="co">#&gt; 6  0.0146962189  0.0634061398  0.0171122204  0.0244459437 -0.0081883427</span></span>
<span id="cb2-82"><a href="#cb2-82" tabindex="-1"></a><span class="co">#&gt;      x2.map:tch    x2.map:ltg    x2.map:glu     x2.tc:ldl     x2.tc:hdl</span></span>
<span id="cb2-83"><a href="#cb2-83" tabindex="-1"></a><span class="co">#&gt; 1 -0.0138251131 -0.0101938361 -0.0257784633 -0.0068689647  0.0398230899</span></span>
<span id="cb2-84"><a href="#cb2-84" tabindex="-1"></a><span class="co">#&gt; 2  0.0098745200  0.0203696547  0.0313619644 -0.0262353123 -0.0164622948</span></span>
<span id="cb2-85"><a href="#cb2-85" tabindex="-1"></a><span class="co">#&gt; 3 -0.0122818754 -0.0203183065 -0.0149534838 -0.0065969775  0.0300168640</span></span>
<span id="cb2-86"><a href="#cb2-86" tabindex="-1"></a><span class="co">#&gt; 4 -0.0397827564 -0.0385992765 -0.0109701272 -0.0242291837 -0.0122792654</span></span>
<span id="cb2-87"><a href="#cb2-87" tabindex="-1"></a><span class="co">#&gt; 5 -0.0138251131 -0.0356386917 -0.0386583542 -0.0276482686 -0.0018670731</span></span>
<span id="cb2-88"><a href="#cb2-88" tabindex="-1"></a><span class="co">#&gt; 6  0.0195036026 -0.0020081382  0.0201031994  0.0483666130 -0.0654803859</span></span>
<span id="cb2-89"><a href="#cb2-89" tabindex="-1"></a><span class="co">#&gt;       x2.tc:tch     x2.tc:ltg     x2.tc:glu    x2.ldl:hdl    x2.ldl:tch</span></span>
<span id="cb2-90"><a href="#cb2-90" tabindex="-1"></a><span class="co">#&gt; 1 -0.0193030537 -0.0428915072  0.0009629700  0.0423549304 -0.0220378305</span></span>
<span id="cb2-91"><a href="#cb2-91" tabindex="-1"></a><span class="co">#&gt; 2 -0.0155012002 -0.0123430995  0.0009326831 -0.0212564243 -0.0115642516</span></span>
<span id="cb2-92"><a href="#cb2-92" tabindex="-1"></a><span class="co">#&gt; 3 -0.0192411418 -0.0271777643  0.0098716066  0.0335869646 -0.0220633407</span></span>
<span id="cb2-93"><a href="#cb2-93" tabindex="-1"></a><span class="co">#&gt; 4 -0.0140331587 -0.0186440420 -0.0188580962 -0.0098784247 -0.0099839514</span></span>
<span id="cb2-94"><a href="#cb2-94" tabindex="-1"></a><span class="co">#&gt; 5 -0.0214699727 -0.0270791696 -0.0203958711  0.0123759491 -0.0240914053</span></span>
<span id="cb2-95"><a href="#cb2-95" tabindex="-1"></a><span class="co">#&gt; 6  0.0701909475  0.0350969957  0.1309600895 -0.0612519836  0.0717191451</span></span>
<span id="cb2-96"><a href="#cb2-96" tabindex="-1"></a><span class="co">#&gt;      x2.ldl:ltg    x2.ldl:glu    x2.hdl:tch    x2.hdl:ltg    x2.hdl:glu</span></span>
<span id="cb2-97"><a href="#cb2-97" tabindex="-1"></a><span class="co">#&gt; 1 -0.0311245646 -0.0009221095  0.0334936252  0.0008521487  0.0311502576</span></span>
<span id="cb2-98"><a href="#cb2-98" tabindex="-1"></a><span class="co">#&gt; 2  0.0129733755  0.0237834359 -0.0238146613 -0.0945055990 -0.1403775894</span></span>
<span id="cb2-99"><a href="#cb2-99" tabindex="-1"></a><span class="co">#&gt; 3 -0.0180161691  0.0049134553  0.0329558784  0.0182807986  0.0327952439</span></span>
<span id="cb2-100"><a href="#cb2-100" tabindex="-1"></a><span class="co">#&gt; 4 -0.0033727555 -0.0191092832  0.0081586184  0.0018977323  0.0215138966</span></span>
<span id="cb2-101"><a href="#cb2-101" tabindex="-1"></a><span class="co">#&gt; 5 -0.0268464903 -0.0296874121  0.0309841399  0.0144891320  0.0053856590</span></span>
<span id="cb2-102"><a href="#cb2-102" tabindex="-1"></a><span class="co">#&gt; 6  0.0560369456  0.1496630223 -0.0278444433 -0.0180308997 -0.0755127518</span></span>
<span id="cb2-103"><a href="#cb2-103" tabindex="-1"></a><span class="co">#&gt;      x2.tch:ltg    x2.tch:glu    x2.ltg:glu</span></span>
<span id="cb2-104"><a href="#cb2-104" tabindex="-1"></a><span class="co">#&gt; 1 -0.0281911757 -0.0176581553 -0.0277936831</span></span>
<span id="cb2-105"><a href="#cb2-105" tabindex="-1"></a><span class="co">#&gt; 2  0.0252977155  0.0530335390  0.1040132768</span></span>
<span id="cb2-106"><a href="#cb2-106" tabindex="-1"></a><span class="co">#&gt; 3 -0.0273318271 -0.0172359590 -0.0223037368</span></span>
<span id="cb2-107"><a href="#cb2-107" tabindex="-1"></a><span class="co">#&gt; 4 -0.0120454909 -0.0248722040 -0.0250419367</span></span>
<span id="cb2-108"><a href="#cb2-108" tabindex="-1"></a><span class="co">#&gt; 5 -0.0255745144 -0.0161804685  0.0087351987</span></span>
<span id="cb2-109"><a href="#cb2-109" tabindex="-1"></a><span class="co">#&gt; 6  0.0339989574  0.1261465729  0.0577886517</span></span>
<span id="cb2-110"><a href="#cb2-110" tabindex="-1"></a></span>
<span id="cb2-111"><a href="#cb2-111" tabindex="-1"></a><span class="co"># Extract response and predictors</span></span>
<span id="cb2-112"><a href="#cb2-112" tabindex="-1"></a>y <span class="ot">&lt;-</span> diabetes<span class="sc">$</span>y</span>
<span id="cb2-113"><a href="#cb2-113" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(diabetes<span class="sc">$</span>x)</span>
<span id="cb2-114"><a href="#cb2-114" tabindex="-1"></a></span>
<span id="cb2-115"><a href="#cb2-115" tabindex="-1"></a><span class="co"># Display original dimensions</span></span>
<span id="cb2-116"><a href="#cb2-116" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Original dimensions:&quot;</span>, <span class="fu">nrow</span>(X), <span class="st">&quot;observations,&quot;</span>, <span class="fu">ncol</span>(X), <span class="st">&quot;predictors</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-117"><a href="#cb2-117" tabindex="-1"></a><span class="co">#&gt; Original dimensions: 442 observations, 1 predictors</span></span></code></pre></div>
</div>
<div id="feature-engineering" class="section level1">
<h1>Feature Engineering</h1>
<p>We create second-order polynomial features (interactions and
quadratics) to increase the predictor space:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Create formula for second-order terms</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>formula_expanded <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">&quot;~ (&quot;</span>, <span class="fu">paste</span>(<span class="fu">colnames</span>(X), <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>), <span class="st">&quot;)^2 + I(&quot;</span>, </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="fu">colnames</span>(X), <span class="st">&quot;^2&quot;</span>, <span class="at">collapse =</span> <span class="st">&quot;) + I(&quot;</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># Generate expanded feature matrix</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>X_expanded <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">model.matrix</span>(formula_expanded, <span class="at">data =</span> X))</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>X_expanded <span class="ot">&lt;-</span> X_expanded[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># remove intercept</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># Clean column names to avoid formula issues</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="fu">colnames</span>(X_expanded) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">colnames</span>(X_expanded), <span class="at">unique =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Expanded dimensions:&quot;</span>, <span class="fu">ncol</span>(X_expanded), <span class="st">&quot;predictors</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; Expanded dimensions: 20 predictors</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co"># Standardize predictors</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>X_scaled <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(X_expanded))</span></code></pre></div>
</div>
<div id="traintest-split" class="section level1">
<h1>Train/Test Split</h1>
<p>We use a 70/30 train/test split to evaluate model performance:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(y, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> X_scaled[train_idx, ]</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> X_scaled[<span class="sc">-</span>train_idx, ]</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> y[train_idx]</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> y[<span class="sc">-</span>train_idx]</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Training set:&quot;</span>, <span class="fu">nrow</span>(X_train), <span class="st">&quot;samples</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; Training set: 311 samples</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Test set:&quot;</span>, <span class="fu">nrow</span>(X_test), <span class="st">&quot;samples</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; Test set: 131 samples</span></span></code></pre></div>
</div>
<div id="multi-path-aic-procedure" class="section level1">
<h1>Multi-Path AIC Procedure</h1>
<p>We now apply the complete multi-path AIC selection pipeline:</p>
<div id="algorithm-1-multi-path-forward-selection" class="section level2">
<h2>Algorithm 1: Multi-Path Forward Selection</h2>
<p>We explore multiple competitive model paths using AIC-based
branching:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>forest <span class="ot">&lt;-</span> <span class="fu">build_paths</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">X =</span> X_train,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">y =</span> y_train,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">K =</span> <span class="dv">10</span>,           <span class="co"># Maximum 10 steps</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">eps =</span> <span class="fl">1e-6</span>,       <span class="co"># Minimum AIC improvement</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">delta =</span> <span class="dv">2</span>,        <span class="co"># AIC tolerance for branching</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="at">L =</span> <span class="dv">50</span>,           <span class="co"># Keep top 50 models per step</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Total models explored:&quot;</span>, <span class="fu">nrow</span>(forest<span class="sc">$</span>all_models), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; Total models explored: 105</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Models at final step:&quot;</span>, <span class="fu">nrow</span>(forest<span class="sc">$</span>path_forest<span class="sc">$</span>frontiers[[<span class="fu">length</span>(forest<span class="sc">$</span>path_forest<span class="sc">$</span>frontiers)]]), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Models at final step: 6</span></span></code></pre></div>
</div>
<div id="algorithm-2-stability-estimation" class="section level2">
<h2>Algorithm 2: Stability Estimation</h2>
<p>We assess variable stability across 50 bootstrap resamples:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>stab <span class="ot">&lt;-</span> <span class="fu">stability</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="at">X =</span> X_train,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">y =</span> y_train,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">K =</span> <span class="dv">10</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">eps =</span> <span class="fl">1e-6</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">delta =</span> <span class="dv">2</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="at">L =</span> <span class="dv">50</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="at">B =</span> <span class="dv">50</span>,           <span class="co"># 50 bootstrap resamples</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="at">resample_fraction =</span> <span class="fl">0.8</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co"># Display top stable variables</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Top 10 most stable variables:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; Top 10 most stable variables:</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">head</span>(stab<span class="sc">$</span>pi, <span class="dv">10</span>), <span class="dv">3</span>))</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt;      xbmi      xltg      xmap I.x.2.age I.x.2.glu      xhdl       xtc I.x.2.sex </span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt;     1.000     0.999     0.983     0.760     0.683     0.567     0.529     0.504 </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt;      xsex I.x.2.map </span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt;     0.497     0.407</span></span></code></pre></div>
</div>
<div id="algorithm-3-plausible-model-selection" class="section level2">
<h2>Algorithm 3: Plausible Model Selection</h2>
<p>We filter models using AIC tolerance (Δ = 2) and stability threshold
(τ = 0.6):</p>
<p><strong>Parameter Justification:</strong> - <strong>Delta =
2</strong>: Following the standard guideline (Burnham &amp; Anderson,
2002) that models within 2 AIC units have essentially equivalent
empirical support. - <strong>tua = 0.6</strong>: Ensures we retain only
models built from variables appearing in &gt;60% of resamples, providing
confidence that selected variables are robust to sampling variation.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>plaus <span class="ot">&lt;-</span> <span class="fu">plausible_models</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">forest =</span> forest,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">pi =</span> stab<span class="sc">$</span>pi,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">Delta =</span> <span class="dv">2</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fl">0.6</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Number of plausible models:&quot;</span>, <span class="fu">nrow</span>(plaus<span class="sc">$</span>plausible_models), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; Number of plausible models: 14</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Best AIC:&quot;</span>, <span class="fu">round</span>(plaus<span class="sc">$</span>best_aic, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; Best AIC: 3370.84</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co"># Display variable summary</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Variable inclusion summary:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; Variable inclusion summary:</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(plaus<span class="sc">$</span>summary, <span class="dv">15</span>))</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt;                Variable InclusionProb Stability</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; I.x.2.age     I.x.2.age         1.000     0.760</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; I.x.2.glu     I.x.2.glu         1.000     0.683</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; xbmi               xbmi         1.000     1.000</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; xltg               xltg         1.000     0.999</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; xmap               xmap         1.000     0.983</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; xtc             xtc (-)         0.857     0.529</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; xsex           xsex (-)         0.571     0.497</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; I.x.2.sex I.x.2.sex (-)         0.571     0.504</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; xtch           xtch (-)         0.429     0.369</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt; I.x.2.map I.x.2.map (-)         0.357     0.407</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; xldl           xldl (-)         0.286     0.378</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt; xhdl           xhdl (-)         0.286     0.567</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#————————Outcome</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a>best_aic_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Variable Inclusion and Stability Summary (Best AIC = &quot;</span>, </span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a>                        <span class="fu">round</span>(plaus<span class="sc">$</span>best_aic, <span class="dv">2</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="fu">head</span>(plaus<span class="sc">$</span>summary, <span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> best_aic_text, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">&quot;Arial&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Arial; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Variable Inclusion and Stability Summary (Best AIC = 3370.84)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
InclusionProb
</th>
<th style="text-align:right;">
Stability
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
I.x.2.age
</td>
<td style="text-align:left;">
I.x.2.age
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.760
</td>
</tr>
<tr>
<td style="text-align:left;">
I.x.2.glu
</td>
<td style="text-align:left;">
I.x.2.glu
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.683
</td>
</tr>
<tr>
<td style="text-align:left;">
xbmi
</td>
<td style="text-align:left;">
xbmi
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
xltg
</td>
<td style="text-align:left;">
xltg
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.999
</td>
</tr>
<tr>
<td style="text-align:left;">
xmap
</td>
<td style="text-align:left;">
xmap
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.983
</td>
</tr>
<tr>
<td style="text-align:left;">
xtc
</td>
<td style="text-align:left;">
xtc (-)
</td>
<td style="text-align:right;">
0.857
</td>
<td style="text-align:right;">
0.529
</td>
</tr>
<tr>
<td style="text-align:left;">
xsex
</td>
<td style="text-align:left;">
xsex (-)
</td>
<td style="text-align:right;">
0.571
</td>
<td style="text-align:right;">
0.497
</td>
</tr>
<tr>
<td style="text-align:left;">
I.x.2.sex
</td>
<td style="text-align:left;">
I.x.2.sex (-)
</td>
<td style="text-align:right;">
0.571
</td>
<td style="text-align:right;">
0.504
</td>
</tr>
<tr>
<td style="text-align:left;">
xtch
</td>
<td style="text-align:left;">
xtch (-)
</td>
<td style="text-align:right;">
0.429
</td>
<td style="text-align:right;">
0.369
</td>
</tr>
<tr>
<td style="text-align:left;">
I.x.2.map
</td>
<td style="text-align:left;">
I.x.2.map (-)
</td>
<td style="text-align:right;">
0.357
</td>
<td style="text-align:right;">
0.407
</td>
</tr>
<tr>
<td style="text-align:left;">
xldl
</td>
<td style="text-align:left;">
xldl (-)
</td>
<td style="text-align:right;">
0.286
</td>
<td style="text-align:right;">
0.378
</td>
</tr>
<tr>
<td style="text-align:left;">
xhdl
</td>
<td style="text-align:left;">
xhdl (-)
</td>
<td style="text-align:right;">
0.286
</td>
<td style="text-align:right;">
0.567
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="model-evaluation-on-test-set" class="section level1">
<h1>Model Evaluation on Test Set</h1>
<p>We evaluate the best plausible model on the held-out test set:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(plaus<span class="sc">$</span>plausible_models) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="co"># Extract variables from best model</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  best_model_vars <span class="ot">&lt;-</span> plaus<span class="sc">$</span>plausible_models<span class="sc">$</span>model[[<span class="dv">1</span>]]</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="co"># Fit on training data</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  train_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> y_train, X_train[, best_model_vars, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  final_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> train_df)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  </span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="co"># Predict on test set</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  test_df <span class="ot">&lt;-</span> X_test[, best_model_vars, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_fit, <span class="at">newdata =</span> test_df)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="co"># Compute metrics</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  test_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y_test <span class="sc">-</span> y_pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_fit)</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>  train_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y_train <span class="sc">-</span> train_pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>  test_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(y_test, y_pred)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>  </span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== Best Model Performance ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Variables selected:&quot;</span>, <span class="fu">length</span>(best_model_vars), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Variable names:&quot;</span>, <span class="fu">paste</span>(best_model_vars, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Training RMSE:&quot;</span>, <span class="fu">round</span>(train_rmse, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Test RMSE:&quot;</span>, <span class="fu">round</span>(test_rmse, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Test Correlation:&quot;</span>, <span class="fu">round</span>(test_cor, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;R-squared (train):&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(final_fit)<span class="sc">$</span>r.squared, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>}</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; === Best Model Performance ===</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; Variables selected: 8 </span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; Variable names: I.x.2.age, I.x.2.glu, xbmi, xldl, xltg, xmap, xsex, xtc </span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; Training RMSE: 52.893 </span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; Test RMSE: 52.759 </span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; Test Correlation: 0.746 </span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; R-squared (train): 0.519</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#————————Outcome</span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co"># Create a clean summary table</span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a>performance_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(</span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a>    <span class="st">&quot;Variables selected&quot;</span>,</span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a>    <span class="st">&quot;Variable names&quot;</span>,</span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a>    <span class="st">&quot;Training RMSE&quot;</span>,</span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a>    <span class="st">&quot;Test RMSE&quot;</span>,</span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a>    <span class="st">&quot;Test Correlation&quot;</span>,</span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a>    <span class="st">&quot;Train R-squared&quot;</span>,</span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a>    <span class="st">&quot;AIC (train)&quot;</span></span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a>  ),</span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb8-53"><a href="#cb8-53" tabindex="-1"></a>    <span class="fu">length</span>(best_model_vars),</span>
<span id="cb8-54"><a href="#cb8-54" tabindex="-1"></a>    <span class="fu">paste</span>(best_model_vars, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>),</span>
<span id="cb8-55"><a href="#cb8-55" tabindex="-1"></a>    <span class="fu">round</span>(train_rmse, <span class="dv">3</span>),</span>
<span id="cb8-56"><a href="#cb8-56" tabindex="-1"></a>    <span class="fu">round</span>(test_rmse, <span class="dv">3</span>),</span>
<span id="cb8-57"><a href="#cb8-57" tabindex="-1"></a>    <span class="fu">round</span>(test_cor, <span class="dv">3</span>),</span>
<span id="cb8-58"><a href="#cb8-58" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">summary</span>(final_fit)<span class="sc">$</span>r.squared, <span class="dv">3</span>),</span>
<span id="cb8-59"><a href="#cb8-59" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">AIC</span>(final_fit), <span class="dv">3</span>)</span>
<span id="cb8-60"><a href="#cb8-60" tabindex="-1"></a>  )</span>
<span id="cb8-61"><a href="#cb8-61" tabindex="-1"></a>)</span>
<span id="cb8-62"><a href="#cb8-62" tabindex="-1"></a></span>
<span id="cb8-63"><a href="#cb8-63" tabindex="-1"></a><span class="co"># Pretty kable output</span></span>
<span id="cb8-64"><a href="#cb8-64" tabindex="-1"></a><span class="fu">kbl</span>(</span>
<span id="cb8-65"><a href="#cb8-65" tabindex="-1"></a>  performance_table,</span>
<span id="cb8-66"><a href="#cb8-66" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Best Model Performance Summary&quot;</span>,</span>
<span id="cb8-67"><a href="#cb8-67" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb8-68"><a href="#cb8-68" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span></span>
<span id="cb8-69"><a href="#cb8-69" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb8-70"><a href="#cb8-70" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">&quot;Arial&quot;</span>)  </span></code></pre></div>
<table class=" lightable-classic" style="font-family: Arial; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Best Model Performance Summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:left;">
Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Variables selected
</td>
<td style="text-align:left;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
Variable names
</td>
<td style="text-align:left;">
I.x.2.age, I.x.2.glu, xbmi, xldl, xltg, xmap, xsex, xtc
</td>
</tr>
<tr>
<td style="text-align:left;">
Training RMSE
</td>
<td style="text-align:left;">
52.893
</td>
</tr>
<tr>
<td style="text-align:left;">
Test RMSE
</td>
<td style="text-align:left;">
52.759
</td>
</tr>
<tr>
<td style="text-align:left;">
Test Correlation
</td>
<td style="text-align:left;">
0.746
</td>
</tr>
<tr>
<td style="text-align:left;">
Train R-squared
</td>
<td style="text-align:left;">
0.519
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC (train)
</td>
<td style="text-align:left;">
3370.84
</td>
</tr>
</tbody>
</table>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>This analysis demonstrates the multi-path AIC selection framework on
a challenging regression problem with many correlated predictors. The
procedure successfully:</p>
<ol style="list-style-type: decimal">
<li><strong>Explored multiple competitive model paths</strong> rather
than committing to a single greedy sequence</li>
<li><strong>Identified stable variables</strong> that consistently
appear across bootstrap resamples</li>
<li><strong>Selected plausible models</strong> that balance
goodness-of-fit (low AIC) with stability (reliable variables)</li>
<li><strong>Achieved good predictive performance</strong> on held-out
test data</li>
</ol>
<p>The final model includes 8 predictors and demonstrates that the
multi-path approach can effectively navigate high-dimensional predictor
spaces while maintaining model parsimony.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Efron, B., Hastie, T., Johnstone, I., &amp; Tibshirani, R. (2004).
Least angle regression. <em>The Annals of Statistics</em>, 32(2),
407-499.</p>
<p>Burnham, K. P., &amp; Anderson, D. R. (2002). <em>Model Selection and
Multimodel Inference: A Practical Information-Theoretic Approach</em>
(2nd ed.). Springer.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
